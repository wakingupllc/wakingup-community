-- GENERATED FILE
-- Do not edit this file directly. Instead, start a server and run "yarn makemigrations"
-- as described in the README. This file should nevertheless be checked in to version control.
--
-- Overall schema hash: 678664d5d8ab09286c019fb0848ceb3c

-- Accepted on 2023-12-07T22:06:50.000Z by 20231207T220650.merge_noop_migration.ts

-- Extension "btree_gin", hash: 8833dd03dc128e186d2c560d248354fb
CREATE EXTENSION IF NOT EXISTS "btree_gin" CASCADE;

-- Extension "earthdistance", hash: 146c86937953d18a88cb9b60b840c3af
CREATE EXTENSION IF NOT EXISTS "earthdistance" CASCADE;

-- Extension "intarray", hash: 8d5d2e9e6e441f90af46182b35ef5999
CREATE EXTENSION IF NOT EXISTS "intarray" CASCADE;

-- Extension "vector", hash: 6ba8844da718b4a65f60dbfd0d92d6ef
CREATE EXTENSION IF NOT EXISTS "vector" CASCADE;

-- Schema for "AdvisorRequests", hash: 7d8b2c2f86db29368d55481bc888c1d9
CREATE TABLE "AdvisorRequests" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "interestedInMetaculus" bool DEFAULT false,
    "jobAds" jsonb,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Bans", hash: a277d598355207b56e7ccd21e1e46011
CREATE TABLE "Bans" (
    _id varchar(27) PRIMARY KEY,
    "expirationDate" timestamptz,
    "userId" varchar(27),
    "ip" text,
    "reason" text,
    "comment" text,
    "properties" jsonb,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Books", hash: e14dfdf561ea85845a7e08eb7058bf8a
CREATE TABLE "Books" (
    _id varchar(27) PRIMARY KEY,
    "postedAt" timestamptz,
    "title" text,
    "subtitle" text,
    "tocTitle" text,
    "collectionId" varchar(27) NOT NULL,
    "number" double precision,
    "postIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "sequenceIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "displaySequencesAsGrid" bool,
    "hideProgressBar" bool,
    "showChapters" bool,
    "contents" jsonb,
    "contents_latest" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Chapters", hash: 8cad2c6f9ed2f158af8270acca921dec
CREATE TABLE "Chapters" (
    _id varchar(27) PRIMARY KEY,
    "title" text,
    "subtitle" text,
    "number" double precision,
    "sequenceId" varchar(27),
    "postIds" varchar(27)[] NOT NULL DEFAULT '{}',
    "contents" jsonb,
    "contents_latest" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "ClientIds", hash: aae19b103f48347cbd022e63e26ced3b
CREATE TABLE "ClientIds" (
    _id varchar(27) PRIMARY KEY,
    "clientId" text,
    "firstSeenReferrer" text,
    "firstSeenLandingPage" text,
    "userIds" text[] DEFAULT '{}' ::text[],
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Collections", hash: 802bcfd6004ae0fb5d816c6544fc8ff0
CREATE TABLE "Collections" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "title" text NOT NULL,
    "slug" text NOT NULL,
    "gridImageId" text,
    "firstPageLink" text,
    "hideStartReadingButton" bool,
    "noindex" bool DEFAULT false,
    "contents" jsonb,
    "contents_latest" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "CommentModeratorActions", hash: e43efff233dd4c04432ce7930aadd32d
CREATE TABLE "CommentModeratorActions" (
    _id varchar(27) PRIMARY KEY,
    "commentId" varchar(27),
    "type" text,
    "endedAt" timestamptz,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Comments", hash: e8c4560c2d87989e29048a433dac68f2
CREATE TABLE "Comments" (
    _id varchar(27) PRIMARY KEY,
    "parentCommentId" varchar(27),
    "topLevelCommentId" varchar(27),
    "postedAt" timestamptz,
    "author" text,
    "postId" varchar(27),
    "tagId" varchar(27),
    "tagCommentType" text DEFAULT 'DISCUSSION',
    "subforumStickyPriority" double precision,
    "userId" varchar(27),
    "userIP" text,
    "userAgent" text,
    "referrer" text,
    "authorIsUnreviewed" bool DEFAULT false,
    "answer" bool DEFAULT false,
    "parentAnswerId" varchar(27),
    "directChildrenCount" double precision DEFAULT 0,
    "descendentCount" double precision DEFAULT 0,
    "shortform" bool,
    "shortformFrontpage" bool DEFAULT true,
    "nominatedForReview" text,
    "reviewingForReview" text,
    "lastSubthreadActivity" timestamptz,
    "postVersion" text,
    "promoted" bool,
    "promotedByUserId" varchar(27),
    "promotedAt" timestamptz,
    "hideKarma" bool,
    "legacy" bool DEFAULT false,
    "legacyId" text,
    "legacyPoll" bool DEFAULT false,
    "legacyParentId" text,
    "retracted" bool DEFAULT false,
    "deleted" bool DEFAULT false,
    "deletedPublic" bool DEFAULT false,
    "deletedReason" text,
    "deletedDate" timestamptz,
    "deletedByUserId" varchar(27),
    "spam" bool DEFAULT false,
    "repliesBlockedUntil" timestamptz,
    "needsReview" bool,
    "reviewedByUserId" varchar(27),
    "hideAuthor" bool DEFAULT false,
    "moderatorHat" bool DEFAULT false,
    "hideModeratorHat" bool,
    "isPinnedOnProfile" bool DEFAULT false,
    "title" varchar(500),
    "relevantTagIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "debateResponse" bool,
    "rejected" bool DEFAULT false,
    "modGPTAnalysis" text,
    "modGPTRecommendation" text,
    "rejectedReason" text,
    "rejectedByUserId" varchar(27),
    "af" bool DEFAULT false,
    "suggestForAlignmentUserIds" text[] DEFAULT '{}' ::text[],
    "reviewForAlignmentUserId" text,
    "afDate" timestamptz,
    "moveToAlignmentUserId" varchar(27),
    "agentFoundationsId" text,
    "originalDialogueId" varchar(27),
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "contents" jsonb,
    "contents_latest" text,
    "pingbacks" jsonb,
    "voteCount" double precision DEFAULT 0,
    "baseScore" double precision DEFAULT 0,
    "extendedScore" jsonb,
    "score" double precision DEFAULT 0,
    "inactive" bool,
    "afBaseScore" double precision,
    "afExtendedScore" jsonb,
    "afVoteCount" double precision
);

-- Schema for "Conversations", hash: cd065467ee9421938d204e95ec44267e
CREATE TABLE "Conversations" (
    _id varchar(27) PRIMARY KEY,
    "title" text,
    "participantIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "latestActivity" timestamptz,
    "af" bool,
    "messageCount" double precision DEFAULT 0,
    "moderator" bool,
    "archivedByIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "CronHistories", hash: ba2f120c4f44559c4e5f0f1853bf52df
CREATE TABLE "CronHistories" (
    _id varchar(27) PRIMARY KEY,
    "intendedAt" timestamptz NOT NULL,
    "name" text NOT NULL,
    "startedAt" timestamptz NOT NULL,
    "finishedAt" timestamptz,
    "result" jsonb
);

-- Schema for "DatabaseMetadata", hash: cab758939284adf04437d3cbede97793
CREATE TABLE "DatabaseMetadata" (
    _id varchar(27) PRIMARY KEY,
    "name" text,
    "value" jsonb,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "DebouncerEvents", hash: 9f0ca64ef7311df82d38a5fba9ec6b98
CREATE TABLE "DebouncerEvents" (
    _id varchar(27) PRIMARY KEY,
    "name" text,
    "af" bool,
    "dispatched" bool,
    "failed" bool,
    "delayTime" timestamptz,
    "upperBoundTime" timestamptz,
    "key" text,
    "pendingEvents" text[],
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "DialogueChecks", hash: c797d0d29c421c6e211b0a8591b211b9
CREATE TABLE "DialogueChecks" (
    _id varchar(27) PRIMARY KEY,
    "userId" text NOT NULL,
    "targetUserId" text NOT NULL,
    "checked" bool NOT NULL DEFAULT false,
    "checkedAt" timestamptz NOT NULL,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "DialogueMatchPreferences", hash: 8094e1a80428d3d3a5e6afcfd47e40ee
CREATE TABLE "DialogueMatchPreferences" (
    _id varchar(27) PRIMARY KEY,
    "dialogueCheckId" varchar(27) NOT NULL,
    "topicPreferences" jsonb[] NOT NULL DEFAULT '{}',
    "topicNotes" text NOT NULL DEFAULT '',
    "syncPreference" text NOT NULL,
    "asyncPreference" text NOT NULL,
    "formatNotes" text NOT NULL DEFAULT '',
    "generatedDialogueId" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "DigestPosts", hash: fb8d9230b033323f61ec3b5039a2d588
CREATE TABLE "DigestPosts" (
    _id varchar(27) PRIMARY KEY,
    "digestId" varchar(27),
    "postId" varchar(27),
    "emailDigestStatus" text,
    "onsiteDigestStatus" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Digests", hash: 31e6e4f967d7ab635fcd70dfa3b62a8e
CREATE TABLE "Digests" (
    _id varchar(27) PRIMARY KEY,
    "num" double precision NOT NULL,
    "startDate" timestamptz NOT NULL,
    "endDate" timestamptz,
    "publishedDate" timestamptz,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "ElectionCandidates", hash: 92b2a539534a9b96b94a95f7915bcd72
CREATE TABLE "ElectionCandidates" (
    _id varchar(27) PRIMARY KEY,
    "electionName" text NOT NULL,
    "name" text NOT NULL,
    "logoSrc" text NOT NULL,
    "href" text NOT NULL,
    "fundraiserLink" text,
    "gwwcLink" text,
    "gwwcId" text,
    "description" text NOT NULL,
    "userId" varchar(27) NOT NULL,
    "postCount" double precision NOT NULL DEFAULT 0,
    "tagId" varchar(27) NOT NULL,
    "isElectionFundraiser" bool DEFAULT false,
    "amountRaised" double precision,
    "targetAmount" double precision,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "voteCount" double precision DEFAULT 0,
    "baseScore" double precision DEFAULT 0,
    "extendedScore" jsonb,
    "score" double precision DEFAULT 0,
    "inactive" bool,
    "afBaseScore" double precision,
    "afExtendedScore" jsonb,
    "afVoteCount" double precision
);

-- Schema for "ElectionVotes", hash: 9cd2a30b6b5e16f674d704243eec8a91
CREATE TABLE "ElectionVotes" (
    _id varchar(27) PRIMARY KEY,
    "electionName" text NOT NULL,
    "userId" varchar(27),
    "compareState" jsonb,
    "vote" jsonb,
    "submittedAt" timestamptz,
    "userExplanation" text,
    "userOtherComments" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "ElicitQuestionPredictions", hash: d88e9edfd51ca83ad514a77d69a6779b
CREATE TABLE "ElicitQuestionPredictions" (
    _id varchar(27) PRIMARY KEY,
    "prediction" double precision NOT NULL,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP NOT NULL,
    "notes" text,
    "creator" jsonb NOT NULL,
    "userId" varchar(27),
    "sourceUrl" text,
    "sourceId" text,
    "binaryQuestionId" varchar(27) NOT NULL
);

-- Schema for "ElicitQuestions", hash: 1c37033b645209525d192fa053e13dbb
CREATE TABLE "ElicitQuestions" (
    _id varchar(27) PRIMARY KEY,
    "title" text NOT NULL,
    "notes" text,
    "resolution" text,
    "resolvesBy" timestamptz NOT NULL,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP NOT NULL
);

-- Schema for "EmailTokens", hash: e5ad1bb9271a861a3a69375cabb71b64
CREATE TABLE "EmailTokens" (
    _id varchar(27) PRIMARY KEY,
    "token" text,
    "tokenType" text,
    "userId" varchar(27),
    "usedAt" timestamptz,
    "params" jsonb,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "FeaturedResources", hash: 2230ece20cd2013b66f954e5f3ff009a
CREATE TABLE "FeaturedResources" (
    _id varchar(27) PRIMARY KEY,
    "title" text,
    "body" text,
    "ctaText" text,
    "ctaUrl" text,
    "expiresAt" timestamptz,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "GardenCodes", hash: e637bcc1c1b6ae714e8b018876e8807a
CREATE TABLE "GardenCodes" (
    _id varchar(27) PRIMARY KEY,
    "code" text,
    "title" text DEFAULT 'Guest Day Pass',
    "userId" varchar(27),
    "slug" text,
    "startTime" timestamptz,
    "endTime" timestamptz,
    "fbLink" text,
    "type" text DEFAULT 'public',
    "hidden" bool DEFAULT false,
    "deleted" bool DEFAULT false,
    "afOnly" bool DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "contents" jsonb,
    "contents_latest" text,
    "pingbacks" jsonb
);

-- Schema for "Images", hash: d5c0e2cc0076979514fea7b1d77ca57b
CREATE TABLE "Images" (
    _id varchar(27) PRIMARY KEY,
    "originalUrl" text,
    "cdnHostedUrl" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "LWEvents", hash: fdf2137d21d86500e77a28b472073f1d
CREATE TABLE "LWEvents" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "name" text,
    "documentId" text,
    "important" bool,
    "properties" jsonb,
    "intercom" bool,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "LegacyData", hash: afda363542f6bbd9252c72529ffd8de3
CREATE TABLE "LegacyData" (
    _id varchar(27) PRIMARY KEY,
    "objectId" text,
    "collectionName" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Localgroups", hash: 3d42decdac6f555258157e2975318768
CREATE TABLE "Localgroups" (
    _id varchar(27) PRIMARY KEY,
    "name" text,
    "nameInAnotherLanguage" text,
    "organizerIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "lastActivity" timestamptz,
    "types" text[] DEFAULT '{''LW''}' ::text[],
    "categories" text[],
    "isOnline" bool DEFAULT false,
    "mongoLocation" jsonb,
    "googleLocation" jsonb,
    "location" text,
    "contactInfo" text,
    "facebookLink" text,
    "facebookPageLink" text,
    "meetupLink" text,
    "slackLink" text,
    "website" text,
    "bannerImageId" text,
    "inactive" bool DEFAULT false,
    "deleted" bool DEFAULT false,
    "salesforceId" text,
    "contents" jsonb,
    "contents_latest" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Messages", hash: cede968de6400b3df950063c6ecb6202
CREATE TABLE "Messages" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "conversationId" varchar(27),
    "noEmail" bool DEFAULT false,
    "contents" jsonb,
    "contents_latest" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Migrations", hash: e8b5fc45d740841c4788a34ec9f623d1
CREATE TABLE "Migrations" (
    _id varchar(27) PRIMARY KEY,
    "name" text,
    "started" timestamptz,
    "finished" bool DEFAULT false,
    "succeeded" bool DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "ModerationTemplates", hash: 061a6912094aa8492a987a5b130c550b
CREATE TABLE "ModerationTemplates" (
    _id varchar(27) PRIMARY KEY,
    "name" text,
    "collectionName" text,
    "order" double precision DEFAULT 10,
    "deleted" bool DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "contents" jsonb,
    "contents_latest" text
);

-- Schema for "ModeratorActions", hash: 5c4cdc5126cd40be46707419b488ba95
CREATE TABLE "ModeratorActions" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "type" text,
    "endedAt" timestamptz,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Notifications", hash: 0cd3c666b29b54d0487b249ee56c2a16
CREATE TABLE "Notifications" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "documentId" text,
    "documentType" text,
    "extraData" jsonb,
    "link" text,
    "title" text,
    "message" text,
    "type" text,
    "deleted" bool DEFAULT false,
    "viewed" bool DEFAULT false,
    "emailed" bool DEFAULT false,
    "waitingForBatch" bool DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "PageCache", hash: 3d46bf14ed44998f32f8fb22cf7cddb1
CREATE TABLE "PageCache" (
    _id varchar(27) PRIMARY KEY,
    "path" text,
    "abTestGroups" jsonb,
    "bundleHash" text,
    "renderedAt" timestamptz,
    "expiresAt" timestamptz,
    "ttlMs" double precision,
    "renderResult" jsonb,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "PetrovDayLaunchs", hash: 5b1dee358cd18fda79006cc24eb465b6
CREATE TABLE "PetrovDayLaunchs" (
    _id varchar(27) PRIMARY KEY,
    "launchCode" text,
    "hashedLaunchCode" text,
    "userId" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "PodcastEpisodes", hash: 73707022662f0abded18784c1401cf33
CREATE TABLE "PodcastEpisodes" (
    _id varchar(27) PRIMARY KEY,
    "podcastId" varchar(27),
    "title" text NOT NULL,
    "episodeLink" text NOT NULL,
    "externalEpisodeId" text NOT NULL,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Podcasts", hash: 97180100c8aad811e2f7ad0104a043c0
CREATE TABLE "Podcasts" (
    _id varchar(27) PRIMARY KEY,
    "title" text NOT NULL,
    "applePodcastLink" text,
    "spotifyPodcastLink" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "PostEmbeddings", hash: 050fcb6f0a3a388684ab8c59f97a7bb0
CREATE TABLE "PostEmbeddings" (
    _id varchar(27) PRIMARY KEY,
    "postId" varchar(27) NOT NULL,
    "postHash" text NOT NULL,
    "lastGeneratedAt" timestamptz NOT NULL,
    "model" text NOT NULL,
    "embeddings" VECTOR (1536) NOT NULL,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "PostRecommendations", hash: e4c18d50c5093688a1d9381ba23d85f6
CREATE TABLE "PostRecommendations" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "clientId" text,
    "postId" varchar(27) NOT NULL,
    "strategyName" text NOT NULL,
    "strategySettings" jsonb,
    "recommendationCount" integer NOT NULL DEFAULT 0,
    "lastRecommendedAt" timestamptz NOT NULL,
    "clickedAt" timestamptz,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "PostRelations", hash: d45e1248c5fe29f7acd40f3a09ea83d2
CREATE TABLE "PostRelations" (
    _id varchar(27) PRIMARY KEY,
    "type" text,
    "sourcePostId" varchar(27),
    "targetPostId" varchar(27),
    "order" double precision,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Posts", hash: e2904e780f0bd3a8294f7f504f6e372d
CREATE TABLE "Posts" (
    _id varchar(27) PRIMARY KEY,
    "postedAt" timestamptz,
    "modifiedAt" timestamptz,
    "url" varchar(500),
    "postCategory" text DEFAULT 'post',
    "title" varchar(500) NOT NULL,
    "slug" text,
    "viewCount" double precision DEFAULT 0,
    "lastCommentedAt" timestamptz,
    "clickCount" double precision DEFAULT 0,
    "deletedDraft" bool DEFAULT false,
    "status" double precision,
    "isFuture" bool,
    "sticky" bool DEFAULT false,
    "stickyPriority" integer DEFAULT 2,
    "userIP" text,
    "userAgent" text,
    "referrer" text,
    "author" text,
    "userId" varchar(27),
    "question" bool DEFAULT false,
    "authorIsUnreviewed" bool DEFAULT false,
    "readTimeMinutesOverride" double precision,
    "submitToFrontpage" bool DEFAULT true,
    "hiddenRelatedQuestion" bool DEFAULT false,
    "originalPostRelationSourceId" text,
    "shortform" bool DEFAULT false,
    "canonicalSource" text,
    "nominationCount2018" double precision DEFAULT 0,
    "nominationCount2019" double precision DEFAULT 0,
    "reviewCount2018" double precision DEFAULT 0,
    "reviewCount2019" double precision DEFAULT 0,
    "reviewCount" double precision DEFAULT 0,
    "reviewVoteCount" double precision DEFAULT 0,
    "positiveReviewVoteCount" double precision DEFAULT 0,
    "reviewVoteScoreAF" double precision DEFAULT 0,
    "reviewVotesAF" double precision[] DEFAULT '{}' ::double precision[],
    "reviewVoteScoreHighKarma" double precision DEFAULT 0,
    "reviewVotesHighKarma" double precision[] DEFAULT '{}' ::double precision[],
    "reviewVoteScoreAllKarma" double precision DEFAULT 0,
    "reviewVotesAllKarma" double precision[] DEFAULT '{}' ::double precision[],
    "finalReviewVoteScoreHighKarma" double precision DEFAULT 0,
    "finalReviewVotesHighKarma" double precision[] DEFAULT '{}' ::double precision[],
    "finalReviewVoteScoreAllKarma" double precision DEFAULT 0,
    "finalReviewVotesAllKarma" double precision[] DEFAULT '{}' ::double precision[],
    "finalReviewVoteScoreAF" double precision DEFAULT 0,
    "finalReviewVotesAF" double precision[] DEFAULT '{}' ::double precision[],
    "lastCommentPromotedAt" timestamptz,
    "tagRelevance" jsonb,
    "noIndex" bool DEFAULT false,
    "rsvps" jsonb[],
    "activateRSVPs" bool,
    "nextDayReminderSent" bool DEFAULT false,
    "onlyVisibleToLoggedIn" bool DEFAULT false,
    "onlyVisibleToEstablishedAccounts" bool DEFAULT false,
    "hideFromRecentDiscussions" bool DEFAULT false,
    "votingSystem" text DEFAULT 'twoAxis',
    "podcastEpisodeId" varchar(27),
    "forceAllowType3Audio" bool DEFAULT false,
    "legacy" bool DEFAULT false,
    "legacyId" text,
    "legacySpam" bool DEFAULT false,
    "feedId" varchar(27),
    "feedLink" text,
    "curatedDate" timestamptz,
    "metaDate" timestamptz,
    "suggestForCuratedUserIds" varchar(27)[],
    "frontpageDate" timestamptz,
    "collectionTitle" text,
    "coauthorStatuses" jsonb[],
    "hasCoauthorPermission" bool DEFAULT true,
    "socialPreviewImageId" text,
    "socialPreviewImageAutoUrl" text,
    "socialPreview" jsonb,
    "fmCrosspost" jsonb DEFAULT '{"isCrosspost":false}' ::jsonb,
    "canonicalSequenceId" varchar(27),
    "canonicalCollectionSlug" text,
    "canonicalBookId" varchar(27),
    "canonicalNextPostSlug" text,
    "canonicalPrevPostSlug" text,
    "unlisted" bool DEFAULT false,
    "disableRecommendation" bool DEFAULT false,
    "defaultRecommendation" bool DEFAULT false,
    "hideFromPopularComments" bool DEFAULT false,
    "draft" bool DEFAULT false,
    "wasEverUndrafted" bool NOT NULL DEFAULT false,
    "meta" bool DEFAULT false,
    "hideFrontpageComments" bool DEFAULT false,
    "maxBaseScore" double precision,
    "scoreExceeded2Date" timestamptz,
    "scoreExceeded30Date" timestamptz,
    "scoreExceeded45Date" timestamptz,
    "scoreExceeded75Date" timestamptz,
    "scoreExceeded125Date" timestamptz,
    "scoreExceeded200Date" timestamptz,
    "bannedUserIds" varchar(27)[],
    "commentsLocked" bool,
    "commentsLockedToAccountsCreatedAfter" timestamptz,
    "organizerIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "groupId" varchar(27),
    "eventType" text,
    "isEvent" bool DEFAULT false,
    "reviewedByUserId" varchar(27),
    "reviewForCuratedUserId" varchar(27),
    "startTime" timestamptz,
    "localStartTime" timestamptz,
    "endTime" timestamptz,
    "localEndTime" timestamptz,
    "eventRegistrationLink" text,
    "joinEventLink" text,
    "onlineEvent" bool DEFAULT false,
    "globalEvent" bool DEFAULT false,
    "mongoLocation" jsonb,
    "googleLocation" jsonb,
    "location" text,
    "contactInfo" text,
    "facebookLink" text,
    "meetupLink" text,
    "website" text,
    "eventImageId" text,
    "types" text[],
    "metaSticky" bool DEFAULT false,
    "sharingSettings" jsonb,
    "shareWithUsers" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "linkSharingKey" text,
    "linkSharingKeyUsedBy" varchar(27)[],
    "commentSortOrder" text,
    "hideAuthor" bool DEFAULT false,
    "sideCommentsCache" jsonb,
    "sideCommentVisibility" text,
    "moderationStyle" text,
    "ignoreRateLimits" bool,
    "hideCommentKarma" bool DEFAULT false,
    "commentCount" double precision DEFAULT 0,
    "topLevelCommentCount" double precision DEFAULT 0,
    "criticismTipsDismissed" bool,
    "debate" bool DEFAULT false,
    "collabEditorDialogue" bool DEFAULT false,
    "mostRecentPublishedDialogueResponseDate" timestamptz,
    "rejected" bool DEFAULT false,
    "rejectedReason" text,
    "rejectedByUserId" varchar(27),
    "subforumTagId" varchar(27),
    "af" bool DEFAULT false,
    "afDate" timestamptz,
    "afCommentCount" double precision DEFAULT 0,
    "afLastCommentedAt" timestamptz,
    "afSticky" bool DEFAULT false,
    "suggestForAlignmentUserIds" text[] DEFAULT '{}' ::text[],
    "reviewForAlignmentUserId" text,
    "agentFoundationsId" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "contents" jsonb,
    "contents_latest" text,
    "pingbacks" jsonb,
    "moderationGuidelines" jsonb,
    "moderationGuidelines_latest" text,
    "customHighlight" jsonb,
    "customHighlight_latest" text,
    "voteCount" double precision DEFAULT 0,
    "baseScore" double precision DEFAULT 0,
    "extendedScore" jsonb,
    "score" double precision DEFAULT 0,
    "inactive" bool,
    "afBaseScore" double precision,
    "afExtendedScore" jsonb,
    "afVoteCount" double precision
);

-- Schema for "RSSFeeds", hash: fbaf4d1b0aa6fa4f2df3487686aa0a27
CREATE TABLE "RSSFeeds" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "ownedByUser" bool DEFAULT false,
    "displayFullContent" bool DEFAULT false,
    "nickname" text,
    "url" text,
    "status" text,
    "rawFeed" jsonb,
    "setCanonicalUrl" bool DEFAULT false,
    "importAsDraft" bool DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "ReadStatuses", hash: af3a4de4ac16db7c52cf991ccee49c25
CREATE TABLE "ReadStatuses" (
    _id varchar(27) PRIMARY KEY,
    "postId" varchar(27),
    "tagId" varchar(27),
    "userId" varchar(27),
    "isRead" bool,
    "lastUpdated" timestamptz,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Reports", hash: d085c06c4776df3f0bf534c06d930ed0
CREATE TABLE "Reports" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "reportedUserId" varchar(27),
    "commentId" varchar(27),
    "postId" varchar(27),
    "link" text NOT NULL,
    "claimedUserId" varchar(27),
    "description" text,
    "closedAt" timestamptz,
    "markedAsSpam" bool,
    "reportedAsSpam" bool,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "ReviewVotes", hash: 51fa6d67b90a70571a1a79435e28ee70
CREATE TABLE "ReviewVotes" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "postId" varchar(27),
    "qualitativeScore" integer DEFAULT 4,
    "quadraticScore" integer DEFAULT 0,
    "comment" text,
    "year" text DEFAULT '2018',
    "dummy" bool DEFAULT false,
    "reactions" text[],
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Revisions", hash: 90b01b12b0bb3b34831f2d989426785b
CREATE TABLE "Revisions" (
    _id varchar(27) PRIMARY KEY,
    "documentId" text,
    "collectionName" text,
    "fieldName" text,
    "editedAt" timestamptz,
    "autosaveTimeoutStart" timestamptz,
    "updateType" text,
    "version" text,
    "commitMessage" text,
    "userId" varchar(27),
    "draft" bool,
    "originalContents" jsonb,
    "html" text,
    "wordCount" double precision,
    "changeMetrics" jsonb,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "voteCount" double precision DEFAULT 0,
    "baseScore" double precision DEFAULT 0,
    "extendedScore" jsonb,
    "score" double precision DEFAULT 0,
    "inactive" bool,
    "afBaseScore" double precision,
    "afExtendedScore" jsonb,
    "afVoteCount" double precision
);

-- Schema for "Sequences", hash: 31058b70790531c3e65da4b60d5f749e
CREATE TABLE "Sequences" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "title" text NOT NULL,
    "gridImageId" text,
    "bannerImageId" text,
    "curatedOrder" double precision,
    "userProfileOrder" double precision,
    "draft" bool DEFAULT false,
    "isDeleted" bool DEFAULT false,
    "canonicalCollectionSlug" text,
    "hidden" bool DEFAULT false,
    "hideFromAuthorPage" bool DEFAULT false,
    "noindex" bool DEFAULT false,
    "af" bool DEFAULT false,
    "contents" jsonb,
    "contents_latest" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Sessions", hash: bece207584ea30ad0d7f16387a144498
CREATE TABLE "Sessions" (
    _id text NOT NULL PRIMARY KEY,
    "session" jsonb,
    "expires" timestamptz,
    "lastModified" timestamptz
);

-- Schema for "Spotlights", hash: b697bdef531dd4a68068ba268f516b6f
CREATE TABLE "Spotlights" (
    _id varchar(27) PRIMARY KEY,
    "documentId" text,
    "documentType" text DEFAULT 'Sequence',
    "position" double precision,
    "duration" double precision DEFAULT 3,
    "customTitle" text,
    "customSubtitle" text,
    "headerTitle" text,
    "headerTitleLeftColor" text,
    "headerTitleRightColor" text,
    "lastPromotedAt" timestamptz DEFAULT '1970-01-01T00:00:00.000Z',
    "draft" bool DEFAULT true,
    "showAuthor" bool NOT NULL DEFAULT false,
    "imageFade" bool NOT NULL DEFAULT true,
    "spotlightImageId" text,
    "spotlightDarkImageId" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "description" jsonb,
    "description_latest" text
);

-- Schema for "Subscriptions", hash: bace41062c69eb7571091413669d64d5
CREATE TABLE "Subscriptions" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "state" text,
    "documentId" text,
    "collectionName" text,
    "deleted" bool DEFAULT false,
    "type" text,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "TagFlags", hash: 9fe5201647ce899c0b5d875fbf12f690
CREATE TABLE "TagFlags" (
    _id varchar(27) PRIMARY KEY,
    "name" text,
    "deleted" bool DEFAULT false,
    "slug" text,
    "order" double precision,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "contents" jsonb,
    "contents_latest" text
);

-- Schema for "TagRels", hash: e9888d7a5766bee9edaf3afe7d3f57b8
CREATE TABLE "TagRels" (
    _id varchar(27) PRIMARY KEY,
    "tagId" varchar(27),
    "postId" varchar(27),
    "deleted" bool DEFAULT false,
    "userId" varchar(27),
    "backfilled" bool DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "voteCount" double precision DEFAULT 0,
    "baseScore" double precision DEFAULT 0,
    "extendedScore" jsonb,
    "score" double precision DEFAULT 0,
    "inactive" bool,
    "afBaseScore" double precision,
    "afExtendedScore" jsonb,
    "afVoteCount" double precision
);

-- Schema for "Tags", hash: c5ad6c010daee04e24f29e988f7bc4bf
CREATE TABLE "Tags" (
    _id varchar(27) PRIMARY KEY,
    "name" text,
    "shortName" text,
    "subtitle" text,
    "slug" text,
    "oldSlugs" text[],
    "core" bool DEFAULT false,
    "isPostType" bool DEFAULT false,
    "suggestedAsFilter" bool DEFAULT false,
    "defaultOrder" double precision DEFAULT 0,
    "descriptionTruncationCount" double precision DEFAULT 0,
    "postCount" double precision DEFAULT 0,
    "userId" varchar(27),
    "adminOnly" bool DEFAULT false,
    "canEditUserIds" varchar(27)[],
    "charsAdded" double precision,
    "charsRemoved" double precision,
    "deleted" bool DEFAULT false,
    "lastCommentedAt" timestamptz,
    "lastSubforumCommentAt" timestamptz,
    "needsReview" bool DEFAULT true,
    "reviewedByUserId" varchar(27),
    "wikiGrade" integer DEFAULT 2,
    "wikiOnly" bool DEFAULT false,
    "bannerImageId" text,
    "squareImageId" text,
    "tagFlagsIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "lesswrongWikiImportRevision" text,
    "lesswrongWikiImportSlug" text,
    "lesswrongWikiImportCompleted" bool,
    "htmlWithContributorAnnotations" text,
    "contributionStats" jsonb,
    "introSequenceId" varchar(27),
    "postsDefaultSortOrder" text,
    "canVoteOnRels" text[],
    "isSubforum" bool DEFAULT false,
    "subforumModeratorIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "subforumIntroPostId" varchar(27),
    "parentTagId" varchar(27),
    "subTagIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "autoTagModel" text,
    "autoTagPrompt" text,
    "noindex" bool DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "description" jsonb,
    "description_latest" text,
    "subforumWelcomeText" jsonb,
    "subforumWelcomeText_latest" text,
    "moderationGuidelines" jsonb,
    "moderationGuidelines_latest" text
);

-- Schema for "TypingIndicators", hash: b1ca958f9f88cd30add34274d4f97cb1
CREATE TABLE "TypingIndicators" (
    _id varchar(27) PRIMARY KEY,
    "userId" text NOT NULL,
    "documentId" text NOT NULL,
    "lastUpdated" timestamptz NOT NULL,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "UserActivities", hash: 0ab5700d352f6273e9a280dca6d864d5
CREATE TABLE "UserActivities" (
    _id varchar(27) PRIMARY KEY,
    "visitorId" text,
    "type" text,
    "startDate" timestamptz,
    "endDate" timestamptz,
    "activityArray" double precision[],
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "UserMostValuablePosts", hash: 18360b12e30e6c11cf29b03a02112707
CREATE TABLE "UserMostValuablePosts" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27),
    "postId" varchar(27),
    "deleted" bool DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "UserRateLimits", hash: c620c5dd0be792a2f68614111626f3cf
CREATE TABLE "UserRateLimits" (
    _id varchar(27) PRIMARY KEY,
    "userId" varchar(27) NOT NULL,
    "type" text NOT NULL,
    "intervalUnit" text NOT NULL,
    "intervalLength" double precision NOT NULL,
    "actionsPerInterval" double precision NOT NULL,
    "endedAt" timestamptz,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "UserTagRels", hash: 5a3d10302be2b58e21dc7771941b3927
CREATE TABLE "UserTagRels" (
    _id varchar(27) PRIMARY KEY,
    "tagId" varchar(27),
    "userId" varchar(27),
    "subforumLastVisitedAt" timestamptz,
    "subforumShowUnreadInSidebar" bool NOT NULL DEFAULT true,
    "subforumEmailNotifications" bool NOT NULL DEFAULT false,
    "subforumHideIntroPost" bool DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Schema for "Users", hash: 85bb0930d1a221b12fa0999a53e1106c
CREATE TABLE "Users" (
    _id varchar(27) PRIMARY KEY,
    "username" text,
    "emails" jsonb[],
    "isAdmin" bool,
    "profile" jsonb,
    "services" jsonb,
    "displayName" text,
    "previousDisplayName" text,
    "email" text,
    "slug" text,
    "noindex" bool DEFAULT false,
    "groups" text[],
    "lwWikiImport" bool,
    "theme" jsonb DEFAULT '{"name":"default"}' ::jsonb,
    "lastUsedTimezone" text,
    "whenConfirmationEmailSent" timestamptz,
    "legacy" bool DEFAULT false,
    "commentSorting" text,
    "sortDraftsBy" text,
    "reactPaletteStyle" text DEFAULT 'listView',
    "noKibitz" bool,
    "showHideKarmaOption" bool,
    "showPostAuthorCard" bool,
    "hideIntercom" bool DEFAULT false,
    "markDownPostEditor" bool DEFAULT false,
    "hideElicitPredictions" bool DEFAULT false,
    "hideAFNonMemberInitialWarning" bool DEFAULT false,
    "noSingleLineComments" bool DEFAULT false,
    "noCollapseCommentsPosts" bool DEFAULT false,
    "noCollapseCommentsFrontpage" bool DEFAULT false,
    "hideCommunitySection" bool DEFAULT false,
    "expandedFrontpageSections" jsonb,
    "showCommunityInRecentDiscussion" bool DEFAULT false,
    "hidePostsRecommendations" bool DEFAULT false,
    "petrovOptOut" bool DEFAULT false,
    "acceptedTos" bool DEFAULT false,
    "hideNavigationSidebar" bool,
    "currentFrontpageFilter" text,
    "frontpageFilterSettings" jsonb,
    "hideFrontpageFilterSettingsDesktop" bool,
    "allPostsTimeframe" text,
    "allPostsFilter" text,
    "allPostsSorting" text,
    "allPostsShowLowKarma" bool,
    "allPostsIncludeEvents" bool,
    "allPostsHideCommunity" bool,
    "allPostsOpenSettings" bool,
    "draftsListSorting" text,
    "draftsListShowArchived" bool,
    "draftsListShowShared" bool,
    "lastNotificationsCheck" timestamptz,
    "karma" double precision DEFAULT 0,
    "goodHeartTokens" double precision,
    "moderationStyle" text,
    "moderatorAssistance" bool,
    "collapseModerationGuidelines" bool,
    "bannedUserIds" varchar(27)[],
    "bannedPersonalUserIds" varchar(27)[],
    "bookmarkedPostsMetadata" jsonb[] DEFAULT '{}' ::jsonb[],
    "hiddenPostsMetadata" jsonb[] DEFAULT '{}' ::jsonb[],
    "legacyId" text,
    "deleted" bool DEFAULT false,
    "voteBanned" bool,
    "nullifyVotes" bool,
    "deleteContent" bool,
    "banned" timestamptz,
    "auto_subscribe_to_my_posts" bool DEFAULT true,
    "auto_subscribe_to_my_comments" bool DEFAULT true,
    "autoSubscribeAsOrganizer" bool DEFAULT true,
    "notificationCommentsOnSubscribedPost" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationShortformContent" jsonb DEFAULT '{"channel":"onsite","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationRepliesToMyComments" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationRepliesToSubscribedComments" jsonb DEFAULT '{"channel":"onsite","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationSubscribedUserPost" jsonb DEFAULT '{"channel":"onsite","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationPostsInGroups" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationSubscribedTagPost" jsonb DEFAULT '{"channel":"onsite","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationPrivateMessage" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationSharedWithMe" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationAlignmentSubmissionApproved" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationEventInRadius" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationKarmaPowersGained" jsonb DEFAULT '{"channel":"onsite","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationRSVPs" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationGroupAdministration" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationCommentsOnDraft" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationPostsNominatedReview" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationSubforumUnread" jsonb DEFAULT '{"channel":"onsite","batchingFrequency":"daily","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationNewMention" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationDialogueMessages" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationPublishedDialogueMessages" jsonb DEFAULT '{"channel":"onsite","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationAddedAsCoauthor" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationDebateCommentsOnSubscribedPost" jsonb DEFAULT '{"channel":"onsite","batchingFrequency":"daily","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationDebateReplies" jsonb DEFAULT '{"channel":"onsite","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "notificationDialogueMatch" jsonb DEFAULT '{"channel":"both","batchingFrequency":"realtime","timeOfDayGMT":1,"dayOfWeekGMT":"Monday"}' ::jsonb,
    "hideDialogueFacilitation" bool NOT NULL DEFAULT false,
    "revealChecksToAdmins" bool NOT NULL DEFAULT false,
    "optedInToDialogueFacilitation" bool NOT NULL DEFAULT false,
    "karmaChangeNotifierSettings" jsonb DEFAULT '{"updateFrequency":"daily","timeOfDayGMT":11,"dayOfWeekGMT":"Saturday","showNegativeKarma":false}' ::jsonb,
    "karmaChangeLastOpened" timestamptz,
    "karmaChangeBatchStart" timestamptz,
    "givingSeasonNotifyForVoting" bool DEFAULT false,
    "emailSubscribedToCurated" bool,
    "subscribedToDigest" bool DEFAULT false,
    "subscribedToWelcomeEmails" bool DEFAULT true,
    "unsubscribeFromAll" bool,
    "hideSubscribePoke" bool DEFAULT false,
    "hideMeetupsPoke" bool DEFAULT false,
    "hideHomeRHS" bool DEFAULT false,
    "frontpagePostCount" double precision DEFAULT 0,
    "sequenceCount" double precision DEFAULT 0,
    "sequenceDraftCount" double precision DEFAULT 0,
    "mongoLocation" jsonb,
    "googleLocation" jsonb,
    "location" text,
    "mapLocation" jsonb,
    "mapLocationSet" bool,
    "mapMarkerText" text,
    "htmlMapMarkerText" text,
    "nearbyEventsNotifications" bool DEFAULT false,
    "nearbyEventsNotificationsLocation" jsonb,
    "nearbyEventsNotificationsMongoLocation" jsonb,
    "nearbyEventsNotificationsRadius" double precision,
    "nearbyPeopleNotificationThreshold" double precision,
    "hideFrontpageMap" bool,
    "hideTaggingProgressBar" bool,
    "hideFrontpageBookAd" bool,
    "hideFrontpageBook2019Ad" bool,
    "hideFrontpageBook2020Ad" bool,
    "sunshineNotes" text DEFAULT '',
    "sunshineFlagged" bool DEFAULT false,
    "needsReview" bool DEFAULT false,
    "sunshineSnoozed" bool DEFAULT false,
    "snoozedUntilContentCount" double precision,
    "reviewedByUserId" varchar(27),
    "reviewedAt" timestamptz,
    "afKarma" double precision DEFAULT 0,
    "voteCount" double precision,
    "smallUpvoteCount" double precision,
    "smallDownvoteCount" double precision,
    "bigUpvoteCount" double precision,
    "bigDownvoteCount" double precision,
    "voteReceivedCount" double precision,
    "smallUpvoteReceivedCount" double precision,
    "smallDownvoteReceivedCount" double precision,
    "bigUpvoteReceivedCount" double precision,
    "bigDownvoteReceivedCount" double precision,
    "usersContactedBeforeReview" text[],
    "fullName" text,
    "shortformFeedId" varchar(27),
    "viewUnreviewedComments" bool,
    "partiallyReadSequences" jsonb[],
    "beta" bool,
    "reviewVotesQuadratic" bool,
    "reviewVotesQuadratic2019" bool,
    "reviewVotesQuadratic2020" bool,
    "petrovPressedButtonDate" timestamptz,
    "petrovLaunchCodeDate" timestamptz,
    "defaultToCKEditor" bool,
    "signUpReCaptchaRating" double precision,
    "oldSlugs" text[],
    "noExpandUnreadCommentsReview" bool DEFAULT false,
    "postCount" double precision DEFAULT 0,
    "maxPostCount" double precision DEFAULT 0,
    "commentCount" double precision DEFAULT 0,
    "maxCommentCount" double precision DEFAULT 0,
    "tagRevisionCount" double precision DEFAULT 0,
    "abTestKey" text,
    "abTestOverrides" jsonb,
    "reenableDraftJs" bool,
    "walledGardenInvite" bool,
    "hideWalledGardenUI" bool,
    "walledGardenPortalOnboarded" bool,
    "taggingDashboardCollapsed" bool,
    "usernameUnset" bool DEFAULT false,
    "paymentEmail" text,
    "paymentInfo" text,
    "profileImageId" text,
    "jobTitle" text,
    "organization" text,
    "careerStage" text[],
    "website" text,
    "fmCrosspostUserId" text,
    "linkedinProfileURL" text,
    "facebookProfileURL" text,
    "twitterProfileURL" text,
    "githubProfileURL" text,
    "profileTagIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "organizerOfGroupIds" varchar(27)[] DEFAULT '{}' ::varchar(27)[],
    "programParticipation" text[],
    "postingDisabled" bool,
    "allCommentingDisabled" bool,
    "commentingOnOtherUsersDisabled" bool,
    "conversationsDisabled" bool,
    "acknowledgedNewUserGuidelines" bool,
    "subforumPreferredLayout" text,
    "experiencedIn" text[],
    "interestedIn" text[],
    "allowDatadogSessionReplay" bool DEFAULT false,
    "afPostCount" double precision DEFAULT 0,
    "afCommentCount" double precision DEFAULT 0,
    "afSequenceCount" double precision DEFAULT 0,
    "afSequenceDraftCount" double precision DEFAULT 0,
    "reviewForAlignmentForumUserId" text,
    "afApplicationText" text,
    "afSubmittedApplication" bool,
    "givingSeason2023DonatedFlair" bool DEFAULT false,
    "wu_uuid" uuid,
    "first_name" text,
    "last_name" text,
    "avatar" text,
    "wu_created_at" timestamptz,
    "wu_forum_access" bool,
    "wu_has_ever_been_paid_subscriber" bool,
    "wu_subscription_expires_at" timestamptz,
    "wu_subscription_active" bool,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb,
    "moderationGuidelines" jsonb,
    "moderationGuidelines_latest" text,
    "howOthersCanHelpMe" jsonb,
    "howOthersCanHelpMe_latest" text,
    "howICanHelpOthers" jsonb,
    "howICanHelpOthers_latest" text,
    "biography" jsonb,
    "biography_latest" text,
    "recommendationSettings" jsonb
);

-- Schema for "Votes", hash: d673e63135fcf9e38a0fc39dd482ee6c
CREATE TABLE "Votes" (
    _id varchar(27) PRIMARY KEY,
    "documentId" text,
    "collectionName" text,
    "userId" varchar(27),
    "authorIds" varchar(27)[],
    "voteType" text,
    "extendedVoteType" jsonb,
    "power" double precision,
    "afPower" double precision,
    "cancelled" bool DEFAULT false,
    "isUnvote" bool DEFAULT false,
    "votedAt" timestamptz,
    "documentIsAf" bool DEFAULT false,
    "silenceNotification" bool NOT NULL DEFAULT false,
    "schemaVersion" double precision DEFAULT 1,
    "createdAt" timestamptz DEFAULT CURRENT_TIMESTAMP,
    "legacyData" jsonb
);

-- Function, hash: b46d62a3f1df590b2b32db6f51aa876d
CREATE OR REPLACE FUNCTION fm_build_nested_jsonb(
    target_path TEXT[],
    terminal_element JSONB
  )
    RETURNS JSONB LANGUAGE sql IMMUTABLE AS
   'SELECT JSONB_BUILD_OBJECT(
      target_path[1],
      CASE
        WHEN CARDINALITY(target_path) = 1 THEN terminal_element
        ELSE fm_build_nested_jsonb(
          target_path[2:CARDINALITY(target_path)],
          terminal_element
        )
      END
    );'
  ;

-- Function, hash: 30fda1b23a6dad42fa6f09da3c46b6e9
CREATE OR REPLACE FUNCTION fm_add_to_set(ANYARRAY, ANYELEMENT)
    RETURNS ANYARRAY LANGUAGE sql IMMUTABLE AS
   'SELECT CASE WHEN ARRAY_POSITION($1, $2) IS NULL THEN $1 || $2 ELSE $1 END;'
  ;

-- Function, hash: 73ea4de0fde6ca0eaf892ec947fab593
CREATE OR REPLACE FUNCTION fm_add_to_set(
    base_field JSONB,
    target_path TEXT[],
    value_to_add ANYELEMENT
  )
    RETURNS JSONB LANGUAGE sql IMMUTABLE AS
   'SELECT CASE
    WHEN base_field #> target_path IS NULL
      THEN COALESCE(base_field, ''{}''::JSONB) || fm_build_nested_jsonb(
        target_path,
        JSONB_BUILD_ARRAY(value_to_add)
      )
    WHEN EXISTS (
      SELECT *
      FROM JSONB_ARRAY_ELEMENTS(base_field #> target_path) AS elem
      WHERE elem = TO_JSONB(value_to_add)
    )
      THEN base_field
    ELSE JSONB_INSERT(
      base_field,
      (SUBSTRING(target_path::TEXT FROM ''(.*)}.*$'') || '', -1}'')::TEXT[],
      TO_JSONB(value_to_add),
      TRUE
    )
    END;'
  ;

-- Function, hash: 47cabadc75b8331f567a50b081b94bae
CREATE OR REPLACE FUNCTION fm_post_tag_similarity(
    post_id_a TEXT,
    post_id_b TEXT
  )
    RETURNS FLOAT LANGUAGE sql IMMUTABLE AS
   'SELECT
      COALESCE(SUM(LEAST(a, b))::FLOAT / SUM(GREATEST(a, b))::FLOAT, 0) AS similarity
    FROM (
      SELECT
        GREATEST((a."tagRelevance"->"tagId")::INTEGER, 0) AS a,
        GREATEST((b."tagRelevance"->"tagId")::INTEGER, 0) AS b
      FROM (
        SELECT JSONB_OBJECT_KEYS("tagRelevance") AS "tagId"
        FROM "Posts"
        WHERE "_id" IN (post_id_a, post_id_b)
      ) "allTags"
      JOIN "Posts" a ON a."_id" = post_id_a
      JOIN "Posts" b ON b."_id" = post_id_b
    ) "tagRelevance";'
  ;

-- Function, hash: 41a9827463ed86fb66c5877ce8fd2e6d
CREATE OR REPLACE FUNCTION fm_jsonb_subset(target jsonb, candidate jsonb)
  RETURNS BOOLEAN AS $$
  DECLARE
    key text;
  BEGIN
    FOR key IN SELECT jsonb_object_keys(candidate)
    LOOP
      IF NOT (target ? key AND target->>key = candidate->>key) THEN
        RETURN FALSE;
      END IF;
    END LOOP;

    RETURN TRUE;
  END;
  $$ LANGUAGE plpgsql;
  ;

-- Function, hash: 428d487b3e1991b66366492a805f7408
CREATE OR REPLACE FUNCTION fm_post_tag_ids(post_id TEXT)
    RETURNS TEXT[] LANGUAGE sql IMMUTABLE AS
   'SELECT ARRAY_AGG(tags."tagId")
    FROM "Posts" p
    JOIN (
      SELECT JSONB_OBJECT_KEYS("tagRelevance") AS "tagId"
      FROM "Posts"
      WHERE "_id" = post_id
    ) tags ON p."_id" = post_id
    WHERE (p."tagRelevance"->tags."tagId")::INTEGER >= 1;'
  ;

-- Function, hash: 005a9177ae69ef02fad0868493928c49
CREATE OR REPLACE FUNCTION fm_confidence_sort(
    ups INTEGER,
    downs INTEGER,
    downvote_multiplier FLOAT DEFAULT 1
  ) RETURNS FLOAT LANGUAGE PLPGSQL IMMUTABLE AS $$
  DECLARE
    n INTEGER;
    z FLOAT;
    p FLOAT;
    l FLOAT;
    r float;
    u FLOAT;
  BEGIN
    n := ups + (downs * downvote_multiplier);
    IF n = 0 THEN
      RETURN n;
    END IF;
    z := 1.281551565545;
    p := ups::FLOAT / n::FLOAT;
    l := p + 1 / (2 * n) * z * z;
    r := z * SQRT(p * (1 - p) / n + z * z / (4 * n * n));
    u := 1 + 1 / n * z * z;
    RETURN (l - r) / u;
  END $$
  ;

-- Function, hash: 1d0e667eb1ca49274453f3334fa5931f
CREATE OR REPLACE FUNCTION fm_comment_confidence(
    comment_id TEXT,
    downvote_multiplier FLOAT DEFAULT 1
  ) RETURNS FLOAT LANGUAGE sql AS $$
    SELECT
      fm_confidence_sort(
        COALESCE(
          SUM(v."power") FILTER (WHERE v."voteType" IN ('bigUpvote', 'smallUpvote')),
          0
        )::INTEGER,
        COALESCE(
          -SUM(v."power") FILTER (WHERE v."voteType" IN ('bigDownvote', 'smallDownvote')),
          0
        )::INTEGER,
        downvote_multiplier
      )
    FROM "Comments" c
    JOIN "Votes" v ON
      v."documentId" = c."_id" AND
      v."collectionName" = 'Comments' AND
      v."isUnvote" IS NOT TRUE AND
      v."cancelled" IS NOT TRUE AND
      v."extendedVoteType" IS NULL
    WHERE c."_id" = comment_id;
  $$
  ;

